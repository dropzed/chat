# WebSocket Chat Application

## Установка и запуск

```bash
# Установка зависимостей
$ npm install

# Запуск сервера
$ npm start
```

После запуска откройте браузер и перейдите по адресу: [http://localhost:3000](http://localhost:3000)

## Функциональность приложения

### Аутентификация пользователя
- При загрузке страницы пользователь вводит свое имя
- После ввода имени вызывается событие `setUsername`
- Устанавливается подключение к чату через WebSocket
- Сервер сохраняет имя пользователя в сессии
- Происходит событие `add user`
- Сервер рассылает уведомление `user joined` о новом участнике

### Обмен сообщениями
#### Индикация набора текста
- При начале набора текста клиент отправляет событие `updateTyping`
- Если сообщение еще не отправлено, сервер рассылает событие `typing`
- Другие пользователи видят уведомление "Имя пользователя печатает..."
- При остановке набора клиент отправляет `stop typing`
- Сервер рассылает соответствующее событие, и статус набора скрывается

#### Отправка сообщений
- Пользователь набирает текст и нажимает *Enter*
- Клиент вызывает метод `sendMessage`
- Сервер получает событие `new message`
- Сообщение рассылается всем подключенным клиентам
- Получатели отображают сообщение в общем чате

### Отсоединение от чата
- При закрытии вкладки или обрыве соединения сервер фиксирует событие `disconnect`
- Сервер уменьшает счетчик участников
- Рассылается событие `user left` всем оставшимся клиентам
- Пользователи видят уведомление об уходе участника и обновленное количество онлайн

### Обработка ошибок соединения
- **disconnect** — клиенту показывается сообщение "you have been disconnected"
- **reconnect** — при восстановлении соединения клиент автоматически повторяет процедуру `add user`
- **reconnect_error** — показывается сообщение "attempt to reconnect has failed"

## Мониторинг событий WebSocket

Для отладки работы приложения можно использовать инструменты разработчика браузера:

1. Откройте вкладку **Network**
2. Выберите **WS** (WebSocket) соединение с сервером
3. Во вкладке **Messages** можно наблюдать все передаваемые события:

### Исходящие события (от клиента):
- `add user` — добавление пользователя
- `new message` — новое сообщение
- `typing` — начало набора текста
- `stop typing` — окончание набора

### Входящие события (от сервера):
- `login` — успешный вход в систему
- `user joined` — присоединение нового пользователя
- `user left` — выход пользователя из чата
- `new message` — новое сообщение в чате
- `typing` — уведомление о наборе текста
- `stop typing` — окончание набора текста